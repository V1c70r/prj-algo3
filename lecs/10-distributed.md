# Распределенные алгоритмы

## CAP-теорема Брюэра

Определяет фундаментальные ограничения, которые накладываются на распределенные системы. Она утверждает, что в любой программе из следующих 3-х свойств: консистентрость (C), доступность (A) и усточивость к разделениям сети (P) одновременно в полной мере могут присутствовать только 2. Соответственно, возможны только 3 вида систем: типа CP (не распределенные системы, в которых может быть гарантирована одновременная досутпность и консистентность), CP (распределенные системы, в которых данные всегда находятся в консистентном состоянии, но которые не могут гарантировать постоянную досутпность) и AP (постоянно доступные распределенные системы, в которых не всегд данные будут полностью консистентны). Последний тип часто является наиболее желаательным. Для него можно говорить о двух качествах консистентности, которые достигаются тогда, когда нет сетевых разделений: конечная консистентность (eventual consistency) и сильная конечная консистентность (strong EC).  

## Распределенный консенсус

Агоритмы распределенного консенсуса — это алгоритмы изменения данных в распределенной системе, которые определяют, в каком порядке данные записываются на все нужные узлы и условия успеха такой записи.

Среди них наиболее известны:

- 2х-фазный коммит (2PC)
- 3х-фазный коммит (3PC)
- PAXOS
- RAFT


## Векторные часы

Векторные часы — это механизм частичного упорядочивания событий в распределенной системе, который является альтернативой меткам времени, которые являются ненадежными из-за трудностей синхронизации времени на всех узлах. Они представляют из себя вектор счетчиков, каждый из которых соответствует отдельному узлу сети и меняется им.


## CRDT

Беcконфликтные реплицируемые типы данных — это класс структур данных вместе с операциями над ними (запроса, изменения и слияния), которые обеспечивают сильную конечную консистентность при любых изменениях, которые могут происходить независимо на разных узлах.

По способу передачи информации об изменениях выделяют CvRDT (пересілаются отдельные операции) и CmRDT (пересылается все текущее состояние структуры).

Среди CRDT известны:

- G-счетчик (только увеличивающийся)
- PN-счетчик (позитивно-негативный, с операциями + и -)
- G-множесто (только разрастающееся)
- 2P-множество (множество с возможностью однократного удаления элемента)
- LWW-множество (множество с возможностью добавления и удаления)
- OR-множество (альтернативный вариант множества с возможностью добавления и удаления)

### Операционные трансформации

Операционна ятрансформация (OT) — это протокол, который описывает способ передачи операций изменения данных и их слияния, так, чтобы добиться максимальной консистентности. В какой-то степени, это более ограниченный аналог CRDT (CvRDT).


## Литература

- http://thesecretlivesofdata.com/raft/
- https://www.quora.com/Distributed-Systems-What-is-a-simple-explanation-of-the-Paxos-algorithm
- https://habrahabr.ru/post/272987/
- http://basho.com/posts/technical/why-vector-clocks-are-easy/
- https://static.googleusercontent.com/media/research.google.com/en//archive/spanner-osdi2012.pdf
- https://medium.com/@istanbul_techie/a-look-at-conflict-free-replicated-data-types-crdt-221a5f629e7e
- https://speakerdeck.com/ajantis/practical-demystification-of-crdts
- https://github.com/pfrazee/crdt_notes
- https://operational-transformation.github.io/
- https://medium.com/@raphlinus/towards-a-unified-theory-of-operational-transformation-and-crdt-70485876f72f
- https://aphyr.com/tags/jepsen
